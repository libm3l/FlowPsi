\subsection{Scalar Transport Equations}

The scalar transport equation in conservative form is written for a
convected scalar, $\phi$ as
\begin{equation}
\frac{\partial \rho \phi}{\partial t} + \nabla \cdot (\rho u \phi) = \nabla\cdot(\lambda \nabla \phi) + S_\phi,
\end{equation}
where $\rho$ is the fluid density, $u$ is the fluid velocity vector,
$\lambda$ is a diffusion coefficient, and $S_\phi$ is a prescribed
source term.  We note that by substituting $\phi=1$ into the above
equation one recovers the global continuity equation.  We discretize
the above equation in time and space to arrive at the expression
\begin{eqnarray}
\label{eq:scalar1}
\frac{\V}{\Delta t} \left[ (1+\psi)(\phi^{n+1}\rho^{n+1}-\phi^n\rho^n) - \psi(\phi^n\rho^n-\phi^{n-1}\rho^{n-1})\right ] = \\\nonumber
 -\sum\phi^{n+1}_u\dot{m}_f + \sum{D_\phi}_f + S_\phi,
\end{eqnarray}
where $\phi_u$ is an upwinded extrapolation of $\phi$ based on the
sign of the face mass flux $\dot{m}$ and ${D_\phi}_f$ is the numerical
diffusion flux for scalar $\phi$.  Note that the discrete continuity equation is given by
\begin{equation}
\frac{\V}{\Delta t} \left[ (1+\psi)(\rho^{n+1}-\rho^n) - \psi(\rho^n-\rho^{n-1})\right ] = - \sum\dot{m}_f.
\label{eq:continuityN}
\end{equation}

To improve the diagonal dominance of the scheme we employ a trick
where we recognize that Eq. (\ref{eq:continuityN}) is zero when
the system of equation is solved, thus we multiply Eq.
(\ref{eq:continuityN}) by $\phi^{n+1}$ and subtract it from Eq.
(\ref{eq:scalar1}) to arrive at the following expression:
\begin{eqnarray}
\frac{\V}{\Delta t} \left[ \left(1+\psi\right)\left(\phi^{n+1}-\phi^n\right)\rho^n - \psi \left(\phi^n\rho^n-\phi^{n-1}\rho^{n-1}\right)+\psi\phi^{n+1}\left(\rho^n-\rho^{n-1}\right)\right ] - \\\nonumber
\left[\phi^{n+1}\sum\dot{m}_f-\sum\phi^{n+1}_u\dot{m}_f + \sum{D_\phi}_f + S_\phi\right] =L_\phi(\phi^{n+1}) = 0.
\label{eq:scalar2}
\end{eqnarray}
The above operator, $L_\phi$, is solved using a Newton method concurrently with the fluid equations.
